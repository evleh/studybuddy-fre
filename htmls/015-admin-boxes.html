<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin Lernkarteien</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/main.css">
</head>
<body>
<div class="mx-auto col-md-6 col-sm-12">
    <nav class="navbar navbar-expand-lg bg-info" id="insert-navbar-here"></nav>
    <div class="container">
        <div class="row">
            <div class="col">
                <h1>Lernkarteien </h1>
                <div>
                    <span class="insert-username-here"></span>
                </div>
            </div>
            <div class="col">
                <a href="014-admin-home-base.html" class="btn btn-primary">zurück zum Admin-Bereich</a>
            </div>

            <div class="col">
                <a class="btn btn-primary" id="backToBoxes">zurück zu Karteien</a>
            </div>
            <div>

                <ul class="list-group" id="list-of-all-boxes">
                </ul>

                <h2 id="questionsTitle"></h2>
                <ul class="list-group" id="list-of-questions">
                    <li></li>
                </ul>

            </div>

            <img class="img-w-margin" src="https://cdn.pixabay.com/photo/2024/05/01/06/40/cat-8731512_1280.jpg">
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
<script type="module" src="../js/default-document-ready-stuff.js"></script>
<script>
    $(document).ready(function() {
        //potential changes to be made once data is imported from database (e.g. problems might occur if boxtitles contain html-tags)
        let boxes = [];

        $("#list-of-questions").hide();
        $("#questionsTitle").hide();
        $("#backToBoxes").hide();
        $.getJSON("../DummyData/boxes.json", function (data) {
            $.each(data, function (index, item) {
                boxes.push(item);
            });
            boxes = boxes.sort((a, b) => a.title.localeCompare(b.title));

            $.each(boxes, function (index, item) {
                let statusPublic;
                if (item.public === "1") {
                    statusPublic = "&#x1F7E2; öffentlich";
                } else {
                    statusPublic = "&#128993; privat";
                }

                let buttonHtml = `<button class='btn-showQuestions' data-title='${item.title.replace(/'/g, "&apos;")}'>Fragen anzeigen</button>`;


                $(document.getElementById("list-of-all-boxes")).append('<li class="list-group-item">'
                    + "<p>" + "<b>Titel:</b> " + "<b>" + item.title + "</b>" + "</p>"
                    + "<p>" + "<b>erstellt von:</b> " + item.author + "</p>"
                    + "<p>" + "<b>Beschreibung:</b> " + item.description + "</p>"
                    + "<p>" + "<b>erstellt am:</b> " + item.date + "</p>"
                    + "<p>" + "<b>Sichtbarkeit: </b>" + statusPublic + "</p>"
                    + buttonHtml
                    + "</li>");

            });

        });

        $(document).on('click', '.btn-showQuestions', function () {
            const selectedBoxTitle = $(this).data('title');


            $("#backToBoxes").show();
            $(document).on('click', '#backToBoxes', function () {
                $("#questionsTitle").hide();
                $("#list-of-questions").hide();
                $("#list-of-all-boxes").show();
                $("#backToBoxes").hide();
            });

            $("#list-of-all-boxes").hide();
            $("#questionsTitle").show();
            document.getElementById("questionsTitle").textContent = selectedBoxTitle;
            $("#list-of-questions").show();

            $("#list-of-questions").empty();


            let questions = [];
            $.getJSON("../DummyData/questions.json", function (data) {
                $.each(data, function (index, item) {
                    questions.push(item);
                });
                $.each(questions, function (index, item) {
                    if (item.box === selectedBoxTitle) {
                        $(document.getElementById("list-of-questions")).append(
                            '<li class="list-group-item">'
                            + "<p><b>Frage: </b>" + item.question + "</p>"
                            + "<p><b>Antwort: </b>" + item.answer + "</p>"
                            + "</li>"
                        );
                    }
                });
            });
        });
    });

</script>
</body>
</html>