<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Öffentliche Lernkarteien</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/main.css">

</head>
<body>
<div class="mx-auto col-md-6 col-sm-12">
    <nav class="navbar navbar-expand-lg bg-info" id="insert-navbar-here"></nav>
    <h1>Öffentliche Lernkarteien</h1>

    <label for="site-search">Lernkartei suchen: </label>
    <input type="search" id="site-search" name="q" />

    <button id="btn-suchen">Suchen</button>
    <button id="btn-alle-anzeigen">alle anzeigen</button>

    <ul class="list-group" id="list-of-shared-boxes">
    </ul>

    <ul class="list-group" id="list-of-search-results">
    </ul>
    
    <img src="https://cdn.pixabay.com/photo/2025/07/25/11/24/cat-9734651_1280.jpg" width="50%">
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
<script type="module" src="../js/default-document-ready-stuff.js"></script>
<script>
    $(document).ready(function() {
        //potential changes to be made once data is imported from database (e.g. problems might occur if boxtitles contain html-tags)
        let boxtitles = [];
        $.getJSON("../DummyData/boxes.json", function(data) {
            $.each(data, function(index, item) {
                if (item.public === "1") {
                    boxtitles.push(item.title);
                }
            });
            boxtitles.sort();

            $.each(boxtitles, function(index, item){
                $(document.getElementById("list-of-shared-boxes")).append('<li class="list-group-item">' + item + "</li>");
            });
        });

        //search function
        $("#btn-alle-anzeigen").hide();

        $("#btn-suchen").click(function(){
            $("#btn-alle-anzeigen").show();
            $("#btn-suchen").hide();
            $("#list-of-shared-boxes").hide();

            let searchValue = $('#site-search').val();
            let searchresults = boxtitles.map(function(item){
                if (item.toLowerCase().includes(searchValue.toLowerCase())) {
                    return item;}
            });
            searchresults = searchresults.filter(element => element !== undefined);
            searchresults.sort();
            console.log(searchresults.length);

            if (searchresults.length === 0) {
                $(document.getElementById("list-of-search-results")).append('<li class="list-group-item">' + "Zu diesen Suchbegriffen konnten leider keine Lernkarteien gefunden werden." + '</li>');
            } else {
                $.each(searchresults, function(index, item) {
                    $(document.getElementById("list-of-search-results")).append('<li class="list-group-item">' + item + "</li>");
                });
            }
            $("#list-of-search-results").show();

        });

        $("#btn-alle-anzeigen").click(function(){
            $("#btn-alle-anzeigen").hide();
            $("#btn-suchen").show();

            $("#list-of-search-results").hide();
            $("#list-of-shared-boxes").show();
            document.getElementById("list-of-search-results").replaceChildren();
            document.getElementById('site-search').value = '';
        });
    });
</script>


</body>
</html>